<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Substrate Runtime Recipes · Substrate Developer Hub</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;This page contains a some minimal working samples which demonstrate different features and functionalities available when developing a custom Substrate runtime.&lt;/p&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Substrate Runtime Recipes · Substrate Developer Hub"/><meta property="og:type" content="website"/><meta property="og:url" content="https://substrate-developer-hub.github.io//"/><meta property="og:description" content="&lt;p&gt;This page contains a some minimal working samples which demonstrate different features and functionalities available when developing a custom Substrate runtime.&lt;/p&gt;
"/><meta property="og:image" content="https://substrate-developer-hub.github.io/img/Substrate-logo.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://substrate-developer-hub.github.io/img/Substrate-logo.svg"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/prism.css"/><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/en"><img class="logo" src="/img/Substrate-logo.svg" alt="Substrate Developer Hub"/><h2 class="headerTitleWithLogo">Substrate Developer Hub</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/en/quickstart/getting-started" target="_self">Docs</a></li><li class=""><a href="/en/tutorials" target="_self">Tutorials</a></li><li class=""><a href="https://www.parity.io/blog/" target="_self">Blog</a></li><li class=""><a href="/en/community/support" target="_self">Community</a></li><li class=""><a href="https://github.com/substrate-developer-hub/" target="_self">GitHub</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg" alt="Languages icon"/>English</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/zh-CN/tutorials/substrate-runtime-recipes">中文</a></li><li><a href="Translate For Us" target="_blank" rel="noreferrer noopener">Help Translate</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Runtime</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Quick Start<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/en/quickstart/getting-started">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/docs/en/quickstart/installing-substrate">Installing Substrate</a></li><li class="navListItem"><a class="navItem" href="/docs/en/quickstart/using-the-substrate-node-and-module-setup-scripts">Using the Substrate node and module setup scripts</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Substrate Overview<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/en/overview/introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/en/overview/extrinsics">Extrinsics</a></li><li class="navListItem"><a class="navItem" href="/docs/en/overview/transaction-lifecycle">Transaction Lifecycle</a></li><li class="navListItem"><a class="navItem" href="/docs/en/overview/low-level-data-format">Low-level Data Format</a></li><li class="navListItem"><a class="navItem" href="/docs/en/overview/glossary">Glossary</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Runtime<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/en/runtime/architecture-of-a-runtime">Architecture of a Runtime</a></li><li class="navListItem"><a class="navItem" href="/docs/en/runtime/substrate-runtime-module-library">Substrate Runtime Module Library</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/en/tutorials/substrate-runtime-recipes">Substrate Runtime Recipes</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Runtime Macros</h4><ul><li class="navListItem"><a class="navItem" href="/docs/en/runtime/macros/construct_runtime">Constructing a Runtime!</a></li><li class="navListItem"><a class="navItem" href="/docs/en/runtime/macros/decl_module">Declaring a Module!</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Runtime Types</h4><ul><li class="navListItem"><a class="navItem" href="/docs/en/runtime/types/call-enum">Call Enum</a></li><li class="navListItem"><a class="navItem" href="/docs/en/runtime/types/event-enum">Event Enum</a></li><li class="navListItem"><a class="navItem" href="/docs/en/runtime/types/genesisconfig-struct">GenesisConfig Struct</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Ecosystem Tools<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/en/ecosystem/keys-seeds-and-the-subkey-tool">Keys, Seeds, and the `subkey` Tool</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/substrate-developer-hub/substrate-developer-hub.github.io/edit/source/docs/tutorials/substrate-runtime-recipes.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 class="postHeaderTitle">Substrate Runtime Recipes</h1></header><article><div><span><p>This page contains a some minimal working samples which demonstrate different features and functionalities available when developing a custom Substrate runtime.</p>
<p>This content is also hosted at <a href="https://substrate.recipes/">https://substrate.recipes/</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="prerequisites"></a><a href="#prerequisites" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prerequisites</h2>
<p>If you do not have <code>substrate</code> installed on your machine yet, check out the <a href="../quickstart/installing-substrate">installation instructions</a>. For this tutorial you will probably want the fast installation.</p>
<pre><code class="hljs css language-bash"><span class="token function">curl</span> https://getsubstrate.io -sSf <span class="token operator">|</span> <span class="token function">bash</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="create-a-substrate-node-template"></a><a href="#create-a-substrate-node-template" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create a Substrate Node Template</h3>
<p>In this tutorial we will be using the <a href="https://github.com/polkadot-js/apps">Polkadot UI</a> to interact with our node. To start, create an instance of the <code>substrate-node-template</code> using the following command:</p>
<pre><code class="hljs css language-bash">substrate-node-new substrate-example <span class="token operator">&lt;</span>name<span class="token operator">></span>
</code></pre>
<p>To extend the default implementation of the <code>substrate-node-template</code>, you will need to modify <code>substrate-example/runtime/src/lib.rs</code>.</p>
<ul>
<li>Add these two lines after the initial declarations:</li>
</ul>
<pre><code class="hljs css language-bash">mod runtime_example
impl runtime_example::Trait <span class="token keyword">for</span> Runtime <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre>
<ul>
<li>Then modify the <code>construct_runtime!()</code> macro to include <code>RuntimeExample</code> at the end:</li>
</ul>
<pre><code class="hljs css language-bash">construct_runtime<span class="token operator">!</span><span class="token punctuation">(</span>
    pub enum Runtime with Log<span class="token punctuation">(</span>InternalLog: DigestItem<span class="token operator">&lt;</span>Hash, Ed25519AuthorityId<span class="token operator">></span><span class="token punctuation">)</span> where
        Block <span class="token operator">=</span> Block,
        NodeBlock <span class="token operator">=</span> opaque::Block,
        UncheckedExtrinsic <span class="token operator">=</span> UncheckedExtrinsic
    <span class="token punctuation">{</span>
        System: system::<span class="token punctuation">{</span>default, Log<span class="token punctuation">(</span>ChangesTrieRoot<span class="token punctuation">)</span><span class="token punctuation">}</span>,
        Timestamp: timestamp::<span class="token punctuation">{</span>Module, Call, Storage, Config<span class="token operator">&lt;</span>T<span class="token operator">></span>, Inherent<span class="token punctuation">}</span>,
        Consensus: consensus::<span class="token punctuation">{</span>Module, Call, Storage, Config<span class="token operator">&lt;</span>T<span class="token operator">></span>, Log<span class="token punctuation">(</span>AuthoritiesChange<span class="token punctuation">)</span>, Inherent<span class="token punctuation">}</span>,
        Aura: aura::<span class="token punctuation">{</span>Module<span class="token punctuation">}</span>,
        Indices: indices,
        Balances: balances,
        Sudo: sudo,
        RuntimeExample: runtime_example::<span class="token punctuation">{</span>Module, Call, Storage<span class="token punctuation">}</span>,
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>We may continue to update this file depending on the needs of our runtime example. However, you should only need to modify these sections, and the examples below should make clear what needs to change.</p>
</blockquote>
<p>Finally, you need to create a new file called <code>runtime_example.rs</code> in the same folder as <code>lib.rs</code>.</p>
<h3><a class="anchor" aria-hidden="true" id="updating-your-runtime"></a><a href="#updating-your-runtime" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Updating Your Runtime</h3>
<p>You can paste any of the runtime samples below into that <code>runtime_examples.rs</code> file and compile the new runtime binaries with:</p>
<pre><code class="hljs css language-bash"><span class="token function">cd</span> substrate-example
cargo build --release
</code></pre>
<p>You should delete the old chain before you start the new one:</p>
<pre><code class="hljs css language-bash">substrate purge-chain --dev
./target/release/substrate-example --dev
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="using-the-polkadot-ui-to-interact"></a><a href="#using-the-polkadot-ui-to-interact" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using the Polkadot UI to Interact</h3>
<p>To simplify interactions with your custom Substrate runtime, we will take advantage of the <a href="https://polkadot.js.org/apps/next/">Polkadot JS UI for Substrate</a>.</p>
<p>By default, this UI is configured to interact with the public Substrate test-network BBQ Birch. To have it connect to your local node, simply go to:</p>
<pre><code class="hljs css language-plaintext">Settings &gt; remote node/endpoint to connect to &gt; Local Node (127.0.0.1:9944)
</code></pre>
<p><img src="https://i.imgur.com/1FpB5aM.png" alt="Polkadot UI Settings Tab"></p>
<p>If the UI connected successfully, you should be able to go to the <strong>Explorer</strong> tab and see the block production process running.</p>
<p><img src="https://i.imgur.com/TXmM0cB.png" alt="Block production process running in Explorer tab"></p>
<p>You can then interact with your custom functions in the <strong>Extrinsics</strong> tab under <strong>runtimeExample</strong>:</p>
<p><img src="https://i.imgur.com/JFXSaHw.png" alt="Custom functions appearing in the Extrinsics tab"></p>
<h4><a class="anchor" aria-hidden="true" id="viewing-storage-variables"></a><a href="#viewing-storage-variables" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Viewing Storage Variables</h4>
<p>If you want to check the value of a storage variable that you created, you can go to:</p>
<pre><code class="hljs css language-plaintext">Chain State &gt; runtimeExampleStorage &gt; (variable name)
</code></pre>
<p>From there you should be able to query the state of the variable. It may return <code>&lt;unknown&gt;</code> if the value has not been set yet.</p>
<p><img src="https://i.imgur.com/JLoWxc3.png" alt="Viewing a storage variable in the Polkadot UI"></p>
<h4><a class="anchor" aria-hidden="true" id="viewing-events"></a><a href="#viewing-events" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Viewing Events</h4>
<p>Some runtime examples below generate <code>Events</code> when functions are run. You can temporarily view these events in the <strong>Explorer</strong> tab under <strong>recent events</strong> if any get generated.</p>
<p><img src="https://i.imgur.com/2jUtBUk.png" alt="An event getting generated in the Explorer tab"></p>
<h4><a class="anchor" aria-hidden="true" id="wasm-runtime-upgrade"></a><a href="#wasm-runtime-upgrade" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>WASM Runtime Upgrade</h4>
<p>Rather than restarting your chain for each update, you can also do an in-place runtime upgrade using the Polkadot UI. If you do this, you will not get runtime messages appearing in your terminal, but you should be able to interact with the chain via the UI just fine. To perform the upgrade, go to:</p>
<pre><code class="hljs css language-plaintext">Extrinsics &gt; Upgrade Key &gt; upgrade(new)
</code></pre>
<p>There, you can select the file icon and upload the wasm file generated when you run <code>./build.sh</code></p>
<pre><code class="hljs css language-plaintext">substrate-example/runtime/wasm/target/wasm32-unknown-unknown/release/node_runtime.compact.wasm
</code></pre>
<p><img src="https://i.imgur.com/rujS3p6.png" alt="Upgrading the Substrate runtime"></p>
<p>Once the upgrade is finalized, you should be able to refresh the UI and see your updates.</p>
<h2><a class="anchor" aria-hidden="true" id="recipes"></a><a href="#recipes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Recipes</h2>
<p>A good general reference for Substrate runtime development can be found in the <a href="https://github.com/paritytech/substrate/blob/master/srml/example/src/lib.rs"><code>srml/example</code> source</a> and the <a href="https://github.com/paritytech/substrate/blob/master/srml/">other SRML modules</a>. The examples below are meant to be minimal working samples of specific features.</p>
<h3><a class="anchor" aria-hidden="true" id="simple-storage"></a><a href="#simple-storage" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Simple Storage</h3>
<p>Create a simple single value storage.</p>
<pre><code class="hljs css language-rust"><span class="token keyword">use</span> support<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>decl_module<span class="token punctuation">,</span> decl_storage<span class="token punctuation">,</span> StorageValue<span class="token punctuation">,</span> dispatch<span class="token punctuation">:</span><span class="token punctuation">:</span>Result<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">pub</span> <span class="token keyword">trait</span> Trait<span class="token punctuation">:</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token macro-rules function">decl_module!</span> <span class="token punctuation">{</span>
  <span class="token keyword">pub</span> <span class="token keyword">struct</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">for</span> <span class="token keyword">enum</span> Call <span class="token keyword">where</span> origin<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Origin <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function">set_value</span><span class="token punctuation">(</span>_origin<span class="token punctuation">,</span> value<span class="token punctuation">:</span> u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
      <span class="token operator">&lt;</span>Value<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">put</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token macro-rules function">decl_storage!</span> <span class="token punctuation">{</span>
  <span class="token keyword">trait</span> Store <span class="token keyword">for</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">as</span> RuntimeExampleStorage <span class="token punctuation">{</span>
    Value<span class="token punctuation">:</span> u32<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="account-mapping"></a><a href="#account-mapping" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Account Mapping</h3>
<p>Create an account to value mapping in storage.</p>
<pre><code class="hljs css language-rust"><span class="token keyword">use</span> support<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>decl_module<span class="token punctuation">,</span> decl_storage<span class="token punctuation">,</span> StorageMap<span class="token punctuation">,</span> dispatch<span class="token punctuation">:</span><span class="token punctuation">:</span>Result<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span>ensure_signed<span class="token punctuation">;</span>

<span class="token keyword">pub</span> <span class="token keyword">trait</span> Trait<span class="token punctuation">:</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token macro-rules function">decl_module!</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">struct</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">for</span> <span class="token keyword">enum</span> Call <span class="token keyword">where</span> origin<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Origin <span class="token punctuation">{</span>
        <span class="token keyword">fn</span> <span class="token function">set_account_value</span><span class="token punctuation">(</span>origin<span class="token punctuation">,</span> value<span class="token punctuation">:</span> u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
            <span class="token keyword">let</span> sender <span class="token operator">=</span> <span class="token function">ensure_signed</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span>?<span class="token punctuation">;</span>
            <span class="token operator">&lt;</span>Value<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">insert</span><span class="token punctuation">(</span>sender<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token macro-rules function">decl_storage!</span> <span class="token punctuation">{</span>
    <span class="token keyword">trait</span> Store <span class="token keyword">for</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">as</span> RuntimeExampleStorage <span class="token punctuation">{</span>
        Value<span class="token punctuation">:</span> map T<span class="token punctuation">:</span><span class="token punctuation">:</span>AccountId <span class="token operator">=></span> u32<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="storage-mapping"></a><a href="#storage-mapping" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Storage Mapping</h3>
<p>Create a key/value mapping in storage.</p>
<pre><code class="hljs css language-rust"><span class="token keyword">use</span> support<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>decl_module<span class="token punctuation">,</span> decl_storage<span class="token punctuation">,</span> StorageMap<span class="token punctuation">,</span> dispatch<span class="token punctuation">:</span><span class="token punctuation">:</span>Result<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">pub</span> <span class="token keyword">trait</span> Trait<span class="token punctuation">:</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token macro-rules function">decl_module!</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">struct</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">for</span> <span class="token keyword">enum</span> Call <span class="token keyword">where</span> origin<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Origin <span class="token punctuation">{</span>
        <span class="token keyword">fn</span> <span class="token function">set_mapping</span><span class="token punctuation">(</span>_origin<span class="token punctuation">,</span> key<span class="token punctuation">:</span> u32<span class="token punctuation">,</span> value<span class="token punctuation">:</span> u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
            <span class="token operator">&lt;</span>Value<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">insert</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token macro-rules function">decl_storage!</span> <span class="token punctuation">{</span>
    <span class="token keyword">trait</span> Store <span class="token keyword">for</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">as</span> RuntimeExampleStorage <span class="token punctuation">{</span>
        Value<span class="token punctuation">:</span> map u32 <span class="token operator">=></span> u32<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="simple-token-transfer-a-name-ex-a"></a><a href="#simple-token-transfer-a-name-ex-a" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Simple Token Transfer <a name = "ex"></a></h3>
<p>If we want to implement a simple token transfer with Substrate, we need to:</p>
<ol>
<li>Set total supply</li>
<li>Establish ownership upon configuration of circulating tokens</li>
<li>Coordinate token transfers with our runtime functions</li>
</ol>
<pre><code class="hljs css language-rust"><span class="token macro-rules function">decl_storage!</span> <span class="token punctuation">{</span>
  <span class="token keyword">trait</span> Store <span class="token keyword">for</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">as</span> Template <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> TotalSupply <span class="token function">get</span><span class="token punctuation">(</span>total_supply<span class="token punctuation">)</span><span class="token punctuation">:</span> u64 <span class="token operator">=</span> <span class="token number">21000000</span><span class="token punctuation">;</span> <span class="token comment">// (1)</span>

    <span class="token keyword">pub</span> BalanceOf <span class="token function">get</span><span class="token punctuation">(</span>balance_of<span class="token punctuation">)</span><span class="token punctuation">:</span> map T<span class="token punctuation">:</span><span class="token punctuation">:</span>AccountId <span class="token operator">=></span> u64<span class="token punctuation">;</span> <span class="token comment">// (3)</span>

    Init <span class="token function">get</span><span class="token punctuation">(</span>is_init<span class="token punctuation">)</span><span class="token punctuation">:</span> bool<span class="token punctuation">;</span> <span class="token comment">// (2)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>We should also set an event for when token transfers occur to notify clients:</p>
<pre><code class="hljs css language-rust"><span class="token function">decl_event!</span><span class="token punctuation">(</span>
    <span class="token keyword">pub</span> <span class="token keyword">enum</span> Event<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token keyword">where</span> AccountId <span class="token operator">=</span> <span class="token operator">&lt;</span>T <span class="token keyword">as</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait<span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>AccountId <span class="token punctuation">{</span>
        <span class="token comment">// event for transfer of tokens</span>
        <span class="token comment">// from, to, value</span>
        <span class="token function">Transfer</span><span class="token punctuation">(</span>AccountId<span class="token punctuation">,</span> AccountId<span class="token punctuation">,</span> u64<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>To integrate this logic into our module, we could write the following code:</p>
<pre><code class="hljs css language-rust"><span class="token macro-rules function">decl_module!</span> <span class="token punctuation">{</span>
  <span class="token keyword">pub</span> <span class="token keyword">struct</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">for</span> <span class="token keyword">enum</span> Call <span class="token keyword">where</span> origin<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Origin <span class="token punctuation">{</span>
      <span class="token comment">// initialize default event handling for this module</span>
      <span class="token keyword">fn</span> deposit_event<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> default<span class="token punctuation">;</span>

      <span class="token comment">// initialize the token</span>
      <span class="token comment">// transfers the total_supply amount to the caller</span>
      <span class="token keyword">fn</span> <span class="token function">init</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
        <span class="token keyword">let</span> sender <span class="token operator">=</span> <span class="token function">ensure_signed</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span>?<span class="token punctuation">;</span>
        <span class="token function">ensure!</span><span class="token punctuation">(</span><span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">is_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">false</span><span class="token punctuation">,</span> <span class="token string">"Already initialized."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token operator">&lt;</span>BalanceOf<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">insert</span><span class="token punctuation">(</span>sender<span class="token punctuation">,</span> <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">total_supply</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token operator">&lt;</span>Init<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// transfer tokens from one account to another</span>
      <span class="token keyword">fn</span> <span class="token function">transfer</span><span class="token punctuation">(</span>origin<span class="token punctuation">,</span> to<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>AccountId<span class="token punctuation">,</span> value<span class="token punctuation">:</span> u64<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
        <span class="token keyword">let</span> sender <span class="token operator">=</span> <span class="token function">ensure_signed</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span>?<span class="token punctuation">;</span>
        <span class="token keyword">let</span> sender_balance <span class="token operator">=</span> <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">balance_of</span><span class="token punctuation">(</span>sender<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">ensure!</span><span class="token punctuation">(</span>sender_balance <span class="token operator">>=</span> value<span class="token punctuation">,</span> <span class="token string">"Not enough balance."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">let</span> updated_from_balance <span class="token operator">=</span> sender_balance<span class="token punctuation">.</span><span class="token function">checked_sub</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ok_or</span><span class="token punctuation">(</span><span class="token string">"overflow in calculating balance"</span><span class="token punctuation">)</span>?<span class="token punctuation">;</span>
        <span class="token keyword">let</span> receiver_balance <span class="token operator">=</span> <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">balance_of</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> updated_to_balance <span class="token operator">=</span> receiver_balance<span class="token punctuation">.</span><span class="token function">checked_add</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ok_or</span><span class="token punctuation">(</span><span class="token string">"overflow in calculating balance"</span><span class="token punctuation">)</span>?<span class="token punctuation">;</span>

        <span class="token comment">// reduce sender's balance</span>
        <span class="token operator">&lt;</span>BalanceOf<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">insert</span><span class="token punctuation">(</span>sender<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> updated_from_balance<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// increase receiver's balance</span>
        <span class="token operator">&lt;</span>BalanceOf<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">insert</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> updated_to_balance<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">deposit_event</span><span class="token punctuation">(</span>RawEvent<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Transfer</span><span class="token punctuation">(</span>sender<span class="token punctuation">,</span> to<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>See the <a href="https://github.com/gautamdhameja/substrate-demo/blob/master/runtime/src/template.rs">full code</a> from this example.</p>
<h3><a class="anchor" aria-hidden="true" id="adding-removing-elements-in-an-unbounded-list"></a><a href="#adding-removing-elements-in-an-unbounded-list" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding/Removing Elements in an Unbounded List</h3>
<p>If the size of our list is not relevant to how we access data, the implementation is straightforward.</p>
<p>For example, let's say that we have a list of <code>proposal</code>s (defined as a struct in our runtime). When a <code>proposal</code> expires, we remove it from our list, but it is not necessary to update the indices of other <code>proposal</code>s that have been added (<em>if</em> we perform checks that a proposal exists in the map before accessing it).</p>
<p>We can store our <code>proposal</code>s in a key-value mapping similar to the initial example:</p>
<pre><code class="hljs css language-rust"><span class="token attribute attr-name">#[cfg_attr(feature = "std", derive(Serialize, Deserialize, Debug))]</span>
<span class="token attribute attr-name">#[derive(Encode, Decode, Clone, PartialEq, Eq)]</span>
<span class="token keyword">struct</span> Proposal<span class="token operator">&lt;</span>Hash<span class="token operator">></span> <span class="token punctuation">{</span>
    details<span class="token punctuation">:</span> Hash<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token macro-rules function">decl_storage!</span> <span class="token punctuation">{</span>
    <span class="token keyword">trait</span> Store <span class="token keyword">for</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">as</span> Example <span class="token punctuation">{</span>
        Proposals <span class="token function">get</span><span class="token punctuation">(</span>proposals<span class="token punctuation">)</span><span class="token punctuation">:</span> map u32 <span class="token operator">=></span> Proposal<span class="token operator">&lt;</span>T<span class="token punctuation">:</span><span class="token punctuation">:</span>Hash<span class="token operator">></span><span class="token punctuation">;</span>
        LargestIndex <span class="token function">get</span><span class="token punctuation">(</span>largest_index<span class="token punctuation">)</span><span class="token punctuation">:</span> u32<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>To add a <code>proposal</code>, we would increment the <code>largest_index</code> and add a <code>proposal</code> at that index:</p>
<pre><code class="hljs css language-rust"><span class="token macro-rules function">decl_module!</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">struct</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">for</span> <span class="token keyword">enum</span> Call <span class="token keyword">where</span> origin<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Origin <span class="token punctuation">{</span>
        <span class="token comment">// other methods</span>

        <span class="token keyword">fn</span> <span class="token function">add_proposal</span><span class="token punctuation">(</span>hash<span class="token punctuation">:</span> Hash<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
            <span class="token comment">// any necessary checks here</span>

            <span class="token comment">// instantiate new proposal</span>
            <span class="token keyword">let</span> prop <span class="token operator">=</span> Proposal <span class="token punctuation">{</span> details<span class="token punctuation">:</span> hash<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

            <span class="token comment">// increment largest index</span>
            <span class="token operator">&lt;</span>LargestIndex<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">mutate</span><span class="token punctuation">(</span><span class="token operator">|</span>count<span class="token operator">|</span> count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// add a proposal at largest_index</span>
            <span class="token keyword">let</span> largest_index <span class="token operator">=</span> <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span>largest_index<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token operator">&lt;</span>Proposals<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">insert</span><span class="token punctuation">(</span>largest_index<span class="token punctuation">,</span> prop<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>To remove a <code>proposal</code>, we can simple invoke the <code>remove</code> method for the <code>StorageMap</code> type at the relevant index. In this case, we do not need to update the indices of other <code>proposal</code>s. This is because order does not matter for this sample.</p>
<pre><code class="hljs css language-rust"><span class="token macro-rules function">decl_module!</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">struct</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">for</span> <span class="token keyword">enum</span> Call <span class="token keyword">where</span> origin<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Origin <span class="token punctuation">{</span>
        <span class="token comment">// other methods</span>

        <span class="token keyword">fn</span> <span class="token function">remove_proposal</span><span class="token punctuation">(</span>index<span class="token punctuation">:</span> u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
            <span class="token comment">// any necessary checks here</span>

            <span class="token comment">// remove proposal at the given index</span>
            <span class="token operator">&lt;</span>Proposals<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">remove</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Because we are not updating the indices of other <code>proposal</code>s in our map, we have to check that a proposal exists before removing it, mutating it, or performing any other relevant operation.</p>
<pre><code class="hljs css language-rust"><span class="token comment">// index is the `u32` that corresponds to the proposal in the `&lt;Proposals&lt;T>>` map</span>
<span class="token function">ensure!</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Proposals<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">exists</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"proposal does not exist at the provided index"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>For a more extensive and complete example of this pattern, see <a href="https://github.com/AmarRSingh/SunshineDAO/runtime/src/dao.rs">SunshineDAO</a>.</p>
<h3><a class="anchor" aria-hidden="true" id="swap-and-pop-for-ordered-lists"></a><a href="#swap-and-pop-for-ordered-lists" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Swap and Pop for Ordered Lists</h3>
<p>When we want to preserve storage such that our list doesn't continue growing even after we remove elements, we can invoke the <strong>swap and pop</strong> method:</p>
<ol>
<li>Swap the element to be removed with the element at the head of our <em>list</em> (the element with the highest index in our map).</li>
<li>Remove the element recently placed at the highest index.</li>
<li>Decrement the <code>LargestIndex</code> value.</li>
</ol>
<p>Continuing with our example, we maintain the same logic for adding proposals (increment <code>LargestIndex</code> and insert entry at the head of our <em>list</em>).  However, we invoke the <em>swap and pop</em> algorithm when removing elements from our list:</p>
<pre><code class="hljs css language-rust"><span class="token macro-rules function">decl_module!</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">struct</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">for</span> <span class="token keyword">enum</span> Call <span class="token keyword">where</span> origin<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Origin <span class="token punctuation">{</span>
        <span class="token comment">// other methods</span>

        <span class="token keyword">fn</span> <span class="token function">remove_proposal</span><span class="token punctuation">(</span>index<span class="token punctuation">:</span> u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
            <span class="token comment">// check that a proposal exists at the given index</span>
            <span class="token function">ensure!</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Proposals<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">exists</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"A proposal does not exist at this index"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">let</span> largest_index <span class="token operator">=</span> <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span>largest_index<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> proposal_to_remove <span class="token operator">=</span> <span class="token operator">&lt;</span>Proposals<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">take</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// swap</span>
            <span class="token keyword">if</span> index <span class="token operator">!=</span> largest_index <span class="token punctuation">{</span>
                <span class="token keyword">let</span> temp <span class="token operator">=</span> <span class="token operator">&lt;</span>Proposals<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">take</span><span class="token punctuation">(</span>largest_index<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token operator">&lt;</span>Proposals<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">insert</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token operator">&lt;</span>Proposals<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">insert</span><span class="token punctuation">(</span>largest_index<span class="token punctuation">,</span> proposal_to_remove<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// pop</span>
            <span class="token operator">&lt;</span>Proposals<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">remove</span><span class="token punctuation">(</span>largest_index<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token operator">&lt;</span>LargestIndex<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">mutate</span><span class="token punctuation">(</span><span class="token operator">|</span>count<span class="token operator">|</span> count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="linked-map"></a><a href="#linked-map" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Linked Map</h3>
<p>To trade performance for simpler code, utilize the <code>linked_map</code> data structure. By implementing <a href="https://crates.parity.io/srml_support/storage/trait.EnumerableStorageMap.html"><code>EnumarableStorageMap</code></a> in addition to <a href="https://crates.parity.io/srml_support/storage/trait.StorageMap.html"><code>StorageMap</code></a>, <code>linked_map</code> provides a method <code>head</code> that yields the head of the <em>list</em>, thereby making it unnecessary to also store the <code>LargestIndex</code>. The <code>enumerate</code> method also returns an <code>Iterator</code> ordered according to when (key, value) pairs were inserted into the map.</p>
<p>To use <code>linked_map</code>, we also need to import <code>EnumerableStorageMap</code>. Here is the new declaration in the <code>decl_storage</code> block:</p>
<pre><code class="hljs css language-rust"><span class="token keyword">use</span> support<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>StorageMap<span class="token punctuation">,</span> EnumerableStorageMap<span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// no StorageValue necessary</span>

<span class="token macro-rules function">decl_storage!</span> <span class="token punctuation">{</span>
    <span class="token keyword">trait</span> Store <span class="token keyword">for</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">as</span> Example <span class="token punctuation">{</span>
        Proposals <span class="token function">get</span><span class="token punctuation">(</span>proposals<span class="token punctuation">)</span><span class="token punctuation">:</span> linked_map u32 <span class="token operator">=></span> Proposal<span class="token operator">&lt;</span>T<span class="token punctuation">:</span><span class="token punctuation">:</span>Hash<span class="token operator">></span><span class="token punctuation">;</span>
        <span class="token comment">// no largest_index value necessary</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Here is our new <code>remove_proposal</code> method:</p>
<pre><code class="hljs css language-rust"><span class="token macro-rules function">decl_module!</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">struct</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">for</span> <span class="token keyword">enum</span> Call <span class="token keyword">where</span> origin<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Origin <span class="token punctuation">{</span>
        <span class="token comment">// other methods</span>

        <span class="token keyword">fn</span> <span class="token function">remove_proposal</span><span class="token punctuation">(</span>index<span class="token punctuation">:</span> u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
            <span class="token comment">// check that a proposal exists at the given index</span>
            <span class="token function">ensure!</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Proposals<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">exists</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"A proposal does not exist at this index"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">let</span> head_index <span class="token operator">=</span> <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span>proposals<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">head</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> proposal_to_remove <span class="token operator">=</span> <span class="token operator">&lt;</span>Proposals<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">take</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token operator">&lt;</span>Proposals<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">insert</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token operator">&lt;</span>Proposals<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">get</span><span class="token punctuation">(</span>head_index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token operator">&lt;</span>Proposals<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">remove</span><span class="token punctuation">(</span>head_index<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>The only caveat is that this implementation incurs some performance costs (vs. solely using <code>StorageMap</code> and <code>StorageValue</code>) because <code>linked_map</code> heap allocates the entire map as an iterator in order to implement the <a href="https://crates.parity.io/srml_support/storage/trait.EnumerableStorageMap.html#tymethod.enumerate"><code>enumerate</code> method</a>.</p>
<h3><a class="anchor" aria-hidden="true" id="higher-order-arrays-with-tuples-and-maps"></a><a href="#higher-order-arrays-with-tuples-and-maps" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Higher Order Arrays with Tuples and Maps</h3>
<p>To represent ownership of multiple items across multiple users, tuples can be used alongside maps in order to emulate arrays.</p>
<p>For example, consider a scenario in which persistent storage keeps track of a <em>social network graph</em> in which each user (represented by an <code>AccountId</code>) has a list of other friends. In this case, it would be convenient to use a 2 dimensional array like:</p>
<pre><code class="hljs css language-rust">SocialNetwork<span class="token punctuation">[</span>AccountId<span class="token punctuation">]</span><span class="token punctuation">[</span>Index<span class="token punctuation">]</span> <span class="token punctuation">-></span> AccountId
</code></pre>
<p>With this data structure, we could see how many friends a given <code>AccountId</code> has by calling:</p>
<pre><code class="hljs css language-rust">SocialNetwork<span class="token punctuation">[</span>AccountId<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>To emulate this data structure in the context of the Substrate runtime storage, we can use tuples and maps (declared in a <code>decl_storage!{}</code> block like previous examples):</p>
<pre><code class="hljs css language-rust">SocialNetwork <span class="token function">get</span><span class="token punctuation">(</span>my_friend<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token function">map</span> <span class="token punctuation">(</span>T<span class="token punctuation">:</span><span class="token punctuation">:</span>AccountId<span class="token punctuation">,</span> u32<span class="token punctuation">)</span> <span class="token operator">=></span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>AccountId<span class="token punctuation">;</span>
SocialNetwork <span class="token function">get</span><span class="token punctuation">(</span>friends_count<span class="token punctuation">)</span><span class="token punctuation">:</span> map T<span class="token punctuation">:</span><span class="token punctuation">:</span>AccountId <span class="token operator">=></span> u32<span class="token punctuation">;</span>
</code></pre>
<p>Patterns that use mappings to emulate higher order data structures are common when managing runtime storage on Substrate. To see this pattern in action, check out <a href="https://shawntabrizi.github.io/substrate-collectables-workshop/#/2/owning-multiple-kitties?id=using-tuples-to-emulate-higher-order-arrays">the Substratekitties Collectables Tutorial</a>.</p>
<h3><a class="anchor" aria-hidden="true" id="string-storage-as-bytemap"></a><a href="#string-storage-as-bytemap" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>String Storage (as Bytemap)</h3>
<p>How to store a string in the runtime using JavaScript to convert the string to hex and back.</p>
<p>Substrate does not directly support Strings. Runtime storage is there to store the state of the business logic on which the runtime operates. It is not to store general data that the UI needs. If you really need to store some arbitrary data into your runtime, you can always create a bytearray (Vec<u8>), however the more logical thing to do is to store a hash to a service like IPFS to then use to fetch data for your UI.</p>
<pre><code class="hljs css language-rust"><span class="token keyword">use</span> support<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>decl_module<span class="token punctuation">,</span> decl_storage<span class="token punctuation">,</span> ensure<span class="token punctuation">,</span> StorageValue<span class="token punctuation">,</span> dispatch<span class="token punctuation">:</span><span class="token punctuation">:</span>Result<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> rstd<span class="token punctuation">:</span><span class="token punctuation">:</span>prelude<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token keyword">pub</span> <span class="token keyword">trait</span> Trait<span class="token punctuation">:</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">const</span> BYTEARRAY_LIMIT<span class="token punctuation">:</span> usize <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">;</span>

<span class="token macro-rules function">decl_module!</span> <span class="token punctuation">{</span>
  <span class="token keyword">pub</span> <span class="token keyword">struct</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">for</span> <span class="token keyword">enum</span> Call <span class="token keyword">where</span> origin<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Origin <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function">set_value</span><span class="token punctuation">(</span>_origin<span class="token punctuation">,</span> value<span class="token punctuation">:</span> Vec<span class="token operator">&lt;</span>u8<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
      <span class="token function">ensure!</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> BYTEARRAY_LIMIT<span class="token punctuation">,</span> Bytearray is too large<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token operator">&lt;</span>Value<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">put</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token macro-rules function">decl_storage!</span> <span class="token punctuation">{</span>
  <span class="token keyword">trait</span> Store <span class="token keyword">for</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">as</span> RuntimeExampleStorage <span class="token punctuation">{</span>
    Value<span class="token punctuation">:</span> Vec<span class="token operator">&lt;</span>u8<span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="javascript-helper-for-string-storage"></a><a href="#javascript-helper-for-string-storage" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JavaScript Helper for String Storage</h4>
<p>We store the string as a bytearray, which is inputted into the Polkadot UI as a hex string. These helper functions can allow you to convert a string to hex and back right in your browser console.</p>
<pre><code class="hljs css language-javascript"><span class="token keyword">function</span> <span class="token function">toHex</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token function">unescape</span><span class="token punctuation">(</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> h <span class="token operator">=</span> <span class="token string">'0x'</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        h <span class="token operator">+=</span> s<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> h
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">fromHex</span><span class="token punctuation">(</span><span class="token parameter">h</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> h<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">+=</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        s <span class="token operator">+=</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">decodeURIComponent</span><span class="token punctuation">(</span><span class="token function">escape</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="adder-with-simple-event"></a><a href="#adder-with-simple-event" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adder with Simple Event</h3>
<p>A simple adding machine which checks for overflow and emits an event with the result, without using storage.</p>
<p>You will need to modify <code>lib.rs</code> for this example. Add <code>type Event = Event;</code> to the trait implementation, remove <code>Storage</code>, and add <code>Event</code> to <code>construct_runtime!()</code> like so:</p>
<pre><code class="hljs css language-rust"><span class="token keyword">impl</span> runtime_example<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait <span class="token keyword">for</span> Runtime <span class="token punctuation">{</span>
    <span class="token keyword">type</span> Event <span class="token operator">=</span> Event<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">...</span>
RuntimeExample<span class="token punctuation">:</span> runtime_example<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>Module<span class="token punctuation">,</span> Call<span class="token punctuation">,</span> Event<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">...</span>
</code></pre>
<pre><code class="hljs css language-rust"><span class="token keyword">use</span> support<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>decl_module<span class="token punctuation">,</span> decl_storage<span class="token punctuation">,</span> decl_event<span class="token punctuation">,</span> dispatch<span class="token punctuation">:</span><span class="token punctuation">:</span>Result<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">pub</span> <span class="token keyword">trait</span> Trait<span class="token punctuation">:</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait <span class="token punctuation">{</span>
    <span class="token keyword">type</span> Event<span class="token punctuation">:</span> From<span class="token operator">&lt;</span>Event<span class="token operator">></span> <span class="token operator">+</span> Into<span class="token operator">&lt;&lt;</span><span class="token keyword">Self</span> <span class="token keyword">as</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait<span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>Event<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token macro-rules function">decl_module!</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">struct</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">for</span> <span class="token keyword">enum</span> Call <span class="token keyword">where</span> origin<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Origin <span class="token punctuation">{</span>
        <span class="token keyword">fn</span> <span class="token function">deposit_event</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> default<span class="token punctuation">;</span>

        <span class="token keyword">fn</span> <span class="token function">add</span><span class="token punctuation">(</span>_origin<span class="token punctuation">,</span> val1<span class="token punctuation">:</span> u32<span class="token punctuation">,</span> val2<span class="token punctuation">:</span> u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
            <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">match</span> val1<span class="token punctuation">.</span><span class="token function">checked_add</span><span class="token punctuation">(</span>val2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">Some</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token operator">=></span> r<span class="token punctuation">,</span>
                None <span class="token operator">=></span> <span class="token keyword">return</span> <span class="token function">Err</span><span class="token punctuation">(</span>Addition overflowed<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">deposit_event</span><span class="token punctuation">(</span>Event<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Added</span><span class="token punctuation">(</span>val1<span class="token punctuation">,</span> val2<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">decl_event!</span><span class="token punctuation">(</span>
    <span class="token keyword">pub</span> <span class="token keyword">enum</span> Event <span class="token punctuation">{</span>
        <span class="token function">Added</span><span class="token punctuation">(</span>u32<span class="token punctuation">,</span> u32<span class="token punctuation">,</span> u32<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="permissioned-function-with-generic-event-onlyowner-ownable"></a><a href="#permissioned-function-with-generic-event-onlyowner-ownable" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Permissioned Function with Generic Event (OnlyOwner, Ownable)</h3>
<p>A basic implementation of a permissioned function which can only be called by the &quot;owner&quot;. An event is emitted when the function is successfully run.</p>
<p>You will need to modify <code>lib.rs</code> for this example. Add <code>type Event = Event;</code> to the trait implementation, and add <code>Event&lt;T&gt;</code> to the <code>construct_runtime()</code> macro:</p>
<pre><code class="hljs css language-rust"><span class="token keyword">impl</span> runtime_example<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait <span class="token keyword">for</span> Runtime <span class="token punctuation">{</span>
    <span class="token keyword">type</span> Event <span class="token operator">=</span> Event<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">...</span>
RuntimeExample<span class="token punctuation">:</span> runtime_example<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>Module<span class="token punctuation">,</span> Call<span class="token punctuation">,</span> Storage<span class="token punctuation">,</span> Event<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">...</span>
</code></pre>
<pre><code class="hljs css language-rust"><span class="token keyword">use</span> support<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>decl_module<span class="token punctuation">,</span> decl_storage<span class="token punctuation">,</span> decl_event<span class="token punctuation">,</span> StorageValue<span class="token punctuation">,</span> dispatch<span class="token punctuation">:</span><span class="token punctuation">:</span>Result<span class="token punctuation">,</span> ensure<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span>ensure_signed<span class="token punctuation">;</span>

<span class="token keyword">pub</span> <span class="token keyword">trait</span> Trait<span class="token punctuation">:</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait <span class="token punctuation">{</span>
    <span class="token keyword">type</span> Event<span class="token punctuation">:</span> From<span class="token operator">&lt;</span>Event<span class="token operator">&lt;</span><span class="token keyword">Self</span><span class="token operator">>></span> <span class="token operator">+</span> Into<span class="token operator">&lt;&lt;</span><span class="token keyword">Self</span> <span class="token keyword">as</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait<span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>Event<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token macro-rules function">decl_module!</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">struct</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">for</span> <span class="token keyword">enum</span> Call <span class="token keyword">where</span> origin<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Origin <span class="token punctuation">{</span>
        <span class="token keyword">fn</span> deposit_event<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> default<span class="token punctuation">;</span>

        <span class="token keyword">fn</span> <span class="token function">init_ownership</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
            <span class="token function">ensure!</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token operator">&lt;</span>Owner<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Owner already exists<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> sender <span class="token operator">=</span> <span class="token function">ensure_signed</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span>?<span class="token punctuation">;</span>
            <span class="token operator">&lt;</span>Owner<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>sender<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">deposit_event</span><span class="token punctuation">(</span>RawEvent<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OwnershipTransferred</span><span class="token punctuation">(</span>sender<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sender<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">fn</span> <span class="token function">transfer_ownership</span><span class="token punctuation">(</span>origin<span class="token punctuation">,</span> newOwner<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>AccountId<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
            <span class="token keyword">let</span> sender <span class="token operator">=</span> <span class="token function">ensure_signed</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span>?<span class="token punctuation">;</span>
            <span class="token function">ensure!</span><span class="token punctuation">(</span>sender <span class="token operator">==</span> <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">owner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> This function can only <span class="token keyword">be</span> called by the owner<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token operator">&lt;</span>Owner<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>newOwner<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">deposit_event</span><span class="token punctuation">(</span>RawEvent<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OwnershipTransferred</span><span class="token punctuation">(</span>sender<span class="token punctuation">,</span> newOwner<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token macro-rules function">decl_storage!</span> <span class="token punctuation">{</span>
    <span class="token keyword">trait</span> Store <span class="token keyword">for</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">as</span> RuntimeExampleStorage <span class="token punctuation">{</span>
        Owner <span class="token function">get</span><span class="token punctuation">(</span>owner<span class="token punctuation">)</span><span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>AccountId<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">decl_event!</span><span class="token punctuation">(</span>
    <span class="token keyword">pub</span> <span class="token keyword">enum</span> Event<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token keyword">where</span> AccountId <span class="token operator">=</span> <span class="token operator">&lt;</span>T <span class="token keyword">as</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait<span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>AccountId <span class="token punctuation">{</span>
        <span class="token function">OwnershipTransferred</span><span class="token punctuation">(</span>AccountId<span class="token punctuation">,</span> AccountId<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="hashing-data"></a><a href="#hashing-data" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Hashing data</h3>
<p>Substrate provides in-built support for hashing data with BlakeTwo256 algorithm. This is available as part of the <code>system</code> trait. The Hashing type under the system trait exposes a function called <code>hash</code>. This function takes a reference of a byte array (<code>Vec&lt;u8&gt;</code>) and produces a BlakeTwo256 hash digest of it.</p>
<p>In the following code snippet, our custom module has a function <code>get_hash</code> which takes a <code>Vec&lt;u8&gt;</code> parameter <code>data</code> and calls the <code>hash</code> function on it.</p>
<pre><code class="hljs css language-rust"><span class="token keyword">use</span> runtime_primitives<span class="token punctuation">:</span><span class="token punctuation">:</span>traits<span class="token punctuation">:</span><span class="token punctuation">:</span>Hash<span class="token punctuation">;</span>
<span class="token keyword">use</span> support<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>decl_module<span class="token punctuation">,</span> dispatch<span class="token punctuation">:</span><span class="token punctuation">:</span>Result<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token punctuation">{</span>system<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token keyword">self</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">pub</span> <span class="token keyword">trait</span> Trait<span class="token punctuation">:</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token macro-rules function">decl_module!</span> <span class="token punctuation">{</span>
  <span class="token keyword">pub</span> <span class="token keyword">struct</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">for</span> <span class="token keyword">enum</span> Call <span class="token keyword">where</span> origin<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Origin <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">get_hash</span><span class="token punctuation">(</span>_origin<span class="token punctuation">,</span> data<span class="token punctuation">:</span> Vec<span class="token operator">&lt;</span>u8<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
      <span class="token keyword">let</span> _digest <span class="token operator">=</span> <span class="token operator">&lt;&lt;</span>T <span class="token keyword">as</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait<span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>Hashing <span class="token keyword">as</span> Hash<span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="storing-structs-with-generics"></a><a href="#storing-structs-with-generics" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Storing Structs with Generics</h3>
<p>A basic runtime which stores custom, nested structs using a combination of Rust primitive types and Substrate specific types via generics. We also show you how to import and use this custom type in both the Polkadot-UI and Substrate-UI.</p>
<pre><code class="hljs css language-rust"><span class="token keyword">use</span> support<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>decl_module<span class="token punctuation">,</span> decl_storage<span class="token punctuation">,</span> StorageMap<span class="token punctuation">,</span> dispatch<span class="token punctuation">:</span><span class="token punctuation">:</span>Result<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">pub</span> <span class="token keyword">trait</span> Trait<span class="token punctuation">:</span> balances<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Encode, Decode, Default)]</span>
<span class="token keyword">pub</span> <span class="token keyword">struct</span> Thing <span class="token operator">&lt;</span>Hash<span class="token punctuation">,</span> Balance<span class="token operator">></span> <span class="token punctuation">{</span>
    my_num<span class="token punctuation">:</span> u32<span class="token punctuation">,</span>
    my_hash<span class="token punctuation">:</span> Hash<span class="token punctuation">,</span>
    my_balance<span class="token punctuation">:</span> Balance<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Encode, Decode, Default)]</span>
<span class="token keyword">pub</span> <span class="token keyword">struct</span> SuperThing <span class="token operator">&lt;</span>Hash<span class="token punctuation">,</span> Balance<span class="token operator">></span> <span class="token punctuation">{</span>
    my_super_num<span class="token punctuation">:</span> u32<span class="token punctuation">,</span>
    my_thing<span class="token punctuation">:</span> Thing<span class="token operator">&lt;</span>Hash<span class="token punctuation">,</span> Balance<span class="token operator">></span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token macro-rules function">decl_module!</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">struct</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">for</span> <span class="token keyword">enum</span> Call <span class="token keyword">where</span> origin<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Origin <span class="token punctuation">{</span>
        <span class="token keyword">fn</span> <span class="token function">set_mapping</span><span class="token punctuation">(</span>_origin<span class="token punctuation">,</span> key<span class="token punctuation">:</span> u32<span class="token punctuation">,</span> num<span class="token punctuation">:</span> u32<span class="token punctuation">,</span> hash<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Hash<span class="token punctuation">,</span> balance<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Balance<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
            <span class="token keyword">let</span> thing <span class="token operator">=</span> Thing <span class="token punctuation">{</span>
                            my_num<span class="token punctuation">:</span> num<span class="token punctuation">,</span>
                            my_hash<span class="token punctuation">:</span> hash<span class="token punctuation">,</span>
                            my_balance<span class="token punctuation">:</span> balance
                        <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token operator">&lt;</span>Value<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">insert</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> thing<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">fn</span> <span class="token function">set_super_mapping</span><span class="token punctuation">(</span>_origin<span class="token punctuation">,</span> key<span class="token punctuation">:</span> u32<span class="token punctuation">,</span> super_num<span class="token punctuation">:</span> u32<span class="token punctuation">,</span> thing_key<span class="token punctuation">:</span> u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
            <span class="token keyword">let</span> thing <span class="token operator">=</span> <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">value</span><span class="token punctuation">(</span>thing_key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> super_thing <span class="token operator">=</span> SuperThing <span class="token punctuation">{</span>
                            my_super_num<span class="token punctuation">:</span> super_num<span class="token punctuation">,</span>
                            my_thing<span class="token punctuation">:</span> thing
                        <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token operator">&lt;</span>SuperValue<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">insert</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> super_thing<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token macro-rules function">decl_storage!</span> <span class="token punctuation">{</span>
    <span class="token keyword">trait</span> Store <span class="token keyword">for</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">as</span> RuntimeExampleStorage <span class="token punctuation">{</span>
        Value <span class="token function">get</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">:</span> map u32 <span class="token operator">=></span> Thing<span class="token operator">&lt;</span>T<span class="token punctuation">:</span><span class="token punctuation">:</span>Hash<span class="token punctuation">,</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Balance<span class="token operator">></span><span class="token punctuation">;</span>
        SuperValue <span class="token function">get</span><span class="token punctuation">(</span>super_value<span class="token punctuation">)</span><span class="token punctuation">:</span> map u32 <span class="token operator">=></span> SuperThing<span class="token operator">&lt;</span>T<span class="token punctuation">:</span><span class="token punctuation">:</span>Hash<span class="token punctuation">,</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Balance<span class="token operator">></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>To access the value of this struct via the UI, you will need to import the structure of your new type so that the UI understand how to decode it.</p>
<h4><a class="anchor" aria-hidden="true" id="structs-in-the-polkadot-ui"></a><a href="#structs-in-the-polkadot-ui" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Structs in the Polkadot UI</h4>
<p>For the Polkadot-UI, you will need to create a JSON file which describes your struct:</p>
<blockquote>
<p>The order of the struct definitions matter here since the UI registers one by one in order.</p>
</blockquote>
<pre><code class="hljs css language-json"><span class="token punctuation">{</span>
    <span class="token property">"Thing"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"my_num"</span><span class="token operator">:</span> <span class="token string">"u32"</span><span class="token punctuation">,</span>
        <span class="token property">"my_hash"</span><span class="token operator">:</span> <span class="token string">"Hash"</span><span class="token punctuation">,</span>
        <span class="token property">"my_balance"</span><span class="token operator">:</span> <span class="token string">"Balance"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"SuperThing"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"my_super_num"</span><span class="token operator">:</span> <span class="token string">"u32"</span><span class="token punctuation">,</span>
        <span class="token property">"my_thing"</span><span class="token operator">:</span> <span class="token string">"Thing"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Then go into the Polkadot UI, and navigate to:</p>
<pre><code class="hljs css language-plaintext">Settings &gt; developer &gt; additional type definitions (JSON)
</code></pre>
<p>Import your JSON file there and press &quot;Save and Reload&quot;. If all went well, you should be able to interact with this value just like any other primitive type.</p>
<h4><a class="anchor" aria-hidden="true" id="structs-in-the-substrate-ui"></a><a href="#structs-in-the-substrate-ui" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Structs in the Substrate UI</h4>
<p>For the Substrate UI, you need to take advantage of a registration function provided by the oo7-substrate module: <code>addCodecTransform()</code>.</p>
<p>In the console, simply type:</p>
<pre><code class="hljs css language-javascript"><span class="token function">addCodecTransform</span><span class="token punctuation">(</span><span class="token string">'Thing&lt;Hash,Balance>'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> my_num<span class="token punctuation">:</span> <span class="token string">'u32'</span><span class="token punctuation">,</span> my_hash<span class="token punctuation">:</span> <span class="token string">'Hash'</span><span class="token punctuation">,</span> my_balance<span class="token punctuation">:</span> <span class="token string">'Balance'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">addCodecTransform</span><span class="token punctuation">(</span><span class="token string">'SuperThing&lt;Hash,Balance>'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> my_super_num<span class="token punctuation">:</span> <span class="token string">'u32'</span><span class="token punctuation">,</span> my_thing<span class="token punctuation">:</span> <span class="token string">'Thing'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>You can add these lines in your <strong>app.jsx</strong> <code>constructor()</code> function to automatically import these types when the page loads.</p>
<h3><a class="anchor" aria-hidden="true" id="working-with-custom-enums-in-polkadot-apps"></a><a href="#working-with-custom-enums-in-polkadot-apps" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Working with Custom Enums in Polkadot Apps</h3>
<p>If you want to register custom Substrate enums in Polkadot Apps, here is a working example.</p>
<p>First, you need to define enums in your Substrate module (Rust):</p>
<pre><code class="hljs css language-rust"><span class="token comment">// Example 1: Simple enum</span>
<span class="token keyword">pub</span> <span class="token keyword">enum</span> VoteKind <span class="token punctuation">{</span>
    Approve<span class="token punctuation">,</span>
    Reject<span class="token punctuation">,</span>
    Slash<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// Example 2: Parametrized enum</span>
<span class="token keyword">pub</span> <span class="token keyword">enum</span> ElectionStage<span class="token operator">&lt;</span>BlockNumber<span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token function">Announcing</span><span class="token punctuation">(</span>BlockNumber<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">Voting</span><span class="token punctuation">(</span>BlockNumber<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">Revealing</span><span class="token punctuation">(</span>BlockNumber<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Second, registers previous enums in TypeScript code of Polkadot Apps. This code could be placed somewhere around <a href="https://github.com/polkadot-js/apps/blob/master/packages/apps/src/index.tsx#L47">https://github.com/polkadot-js/apps/blob/master/packages/apps/src/index.tsx#L47</a></p>
<pre><code class="hljs css language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> BlockNumber <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@polkadot/types'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Enum<span class="token punctuation">,</span> EnumType <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@polkadot/types/codec'</span><span class="token punctuation">;</span>

<span class="token comment">// Example 1: Simple enum</span>

<span class="token keyword">class</span> <span class="token class-name">VoteKind</span> <span class="token keyword">extends</span> <span class="token class-name">Enum</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token parameter">value<span class="token operator">?</span><span class="token punctuation">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token string">'Approve'</span><span class="token punctuation">,</span>
      <span class="token string">'Reject'</span><span class="token punctuation">,</span>
      <span class="token string">'Slash'</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

typeRegistry<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  VoteKind
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Example 2: Parametrized enum</span>

<span class="token keyword">class</span> <span class="token class-name">Announcing</span> <span class="token keyword">extends</span> <span class="token class-name">BlockNumber</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Voting</span> <span class="token keyword">extends</span> <span class="token class-name">BlockNumber</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Revealing</span> <span class="token keyword">extends</span> <span class="token class-name">BlockNumber</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">ElectionStage</span> <span class="token keyword">extends</span> <span class="token class-name">EnumType</span><span class="token operator">&lt;</span>Announcing <span class="token operator">|</span> Voting <span class="token operator">|</span> Revealing<span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token operator">?</span><span class="token punctuation">:</span> any<span class="token punctuation">,</span> index<span class="token operator">?</span><span class="token punctuation">:</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      Announcing<span class="token punctuation">,</span>
      Voting<span class="token punctuation">,</span>
      Revealing
    <span class="token punctuation">}</span><span class="token punctuation">,</span> value<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

typeRegistry<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  Announcing<span class="token punctuation">,</span>
  Voting<span class="token punctuation">,</span>
  Revealing<span class="token punctuation">,</span>
  ElectionStage
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="print-a-message"></a><a href="#print-a-message" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Print a message</h3>
<p>Sometimes we need to print debug messages while building applications. This recipe shows how to print messages for debugging your Substrate runtime code.</p>
<p>You need to include <code>runtime_io</code> crate from the Substrate core in order to use IO functions from within the runtime modules.</p>
<pre><code class="hljs css language-rust"><span class="token keyword">use</span> support<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>decl_module<span class="token punctuation">,</span> dispatch<span class="token punctuation">:</span><span class="token punctuation">:</span>Result<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> runtime_io<span class="token punctuation">;</span>

<span class="token keyword">pub</span> <span class="token keyword">trait</span> Trait<span class="token punctuation">:</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token macro-rules function">decl_module!</span> <span class="token punctuation">{</span>
  <span class="token keyword">pub</span> <span class="token keyword">struct</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">for</span> <span class="token keyword">enum</span> Call <span class="token keyword">where</span> origin<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Origin <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">print_something</span><span class="token punctuation">(</span>_origin<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
      <span class="token comment">// the following line prints a message on the node's terminal/console</span>
      runtime_io<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>Hello World from Substrate <span class="token macro-rules function">Runtime!</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>When this function is executed, the message will appear on the terminal where the Substrate node is running. The following screenshot shows the printed message.
<img src="https://files.readme.io/16b213f-Screenshot_from_2019-01-11_16-29-09.png" alt="Text &quot;Hello World from Substrate Runtime!&quot;"></p>
<h3><a class="anchor" aria-hidden="true" id="make-a-balance-transfer"></a><a href="#make-a-balance-transfer" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Make a Balance Transfer</h3>
<p>You can use the <code>Currency</code> type to safely transfer funds between two accounts. Note that this module does not use the <code>Storage</code> type.</p>
<pre><code class="hljs css language-rust"><span class="token keyword">use</span> support<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>decl_module<span class="token punctuation">,</span> dispatch<span class="token punctuation">:</span><span class="token punctuation">:</span>Result<span class="token punctuation">,</span> Currency<span class="token punctuation">,</span> LockableCurrency<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span>ensure_signed<span class="token punctuation">;</span>

<span class="token keyword">pub</span> <span class="token keyword">trait</span> Trait<span class="token punctuation">:</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait <span class="token punctuation">{</span>
    <span class="token keyword">type</span> Currency<span class="token punctuation">:</span> LockableCurrency<span class="token operator">&lt;</span><span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span>AccountId<span class="token punctuation">,</span> Moment<span class="token operator">=</span><span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span>BlockNumber<span class="token operator">></span><span class="token punctuation">;</span>

    <span class="token keyword">type</span> Event<span class="token punctuation">:</span> From<span class="token operator">&lt;</span>Event<span class="token operator">&lt;</span><span class="token keyword">Self</span><span class="token operator">>></span> <span class="token operator">+</span> Into<span class="token operator">&lt;&lt;</span><span class="token keyword">Self</span> <span class="token keyword">as</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait<span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>Event<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token macro-rules function">decl_module!</span> <span class="token punctuation">{</span>
  <span class="token keyword">pub</span> <span class="token keyword">struct</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">for</span> <span class="token keyword">enum</span> Call <span class="token keyword">where</span> origin<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Origin <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function">transfer_proxy</span><span class="token punctuation">(</span>origin<span class="token punctuation">,</span> to<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>AccountId<span class="token punctuation">,</span> value<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Balance<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
      <span class="token keyword">let</span> sender <span class="token operator">=</span> <span class="token function">ensure_signed</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span>?<span class="token punctuation">;</span>
      T<span class="token punctuation">:</span><span class="token punctuation">:</span>Currency<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">make_transfer</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>sender<span class="token punctuation">,</span> <span class="token operator">&amp;</span>to<span class="token punctuation">,</span> value<span class="token punctuation">)</span>?<span class="token punctuation">;</span>

      <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 6/11/2019 by Joshy Orndorff</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/en/runtime/substrate-runtime-module-library"><span class="arrow-prev">← </span><span>Substrate Runtime Module Library</span></a><a class="docs-next button" href="/docs/en/runtime/macros/construct_runtime"><span>Constructing a Runtime!</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#prerequisites">Prerequisites</a><ul class="toc-headings"><li><a href="#create-a-substrate-node-template">Create a Substrate Node Template</a></li><li><a href="#updating-your-runtime">Updating Your Runtime</a></li><li><a href="#using-the-polkadot-ui-to-interact">Using the Polkadot UI to Interact</a></li></ul></li><li><a href="#recipes">Recipes</a><ul class="toc-headings"><li><a href="#simple-storage">Simple Storage</a></li><li><a href="#account-mapping">Account Mapping</a></li><li><a href="#storage-mapping">Storage Mapping</a></li><li><a href="#simple-token-transfer-a-name-ex-a">Simple Token Transfer &lt;a name = &quot;ex&quot;&gt;&lt;/a&gt;</a></li><li><a href="#adding-removing-elements-in-an-unbounded-list">Adding/Removing Elements in an Unbounded List</a></li><li><a href="#swap-and-pop-for-ordered-lists">Swap and Pop for Ordered Lists</a></li><li><a href="#linked-map">Linked Map</a></li><li><a href="#higher-order-arrays-with-tuples-and-maps">Higher Order Arrays with Tuples and Maps</a></li><li><a href="#string-storage-as-bytemap">String Storage (as Bytemap)</a></li><li><a href="#adder-with-simple-event">Adder with Simple Event</a></li><li><a href="#permissioned-function-with-generic-event-onlyowner-ownable">Permissioned Function with Generic Event (OnlyOwner, Ownable)</a></li><li><a href="#hashing-data">Hashing data</a></li><li><a href="#storing-structs-with-generics">Storing Structs with Generics</a></li><li><a href="#working-with-custom-enums-in-polkadot-apps">Working with Custom Enums in Polkadot Apps</a></li><li><a href="#print-a-message">Print a message</a></li><li><a href="#make-a-balance-transfer">Make a Balance Transfer</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/Substrate-logo.svg" alt="Substrate Developer Hub" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/en/quickstart/getting-started">Getting Started</a><a href="/en/tutorials">Tutorials</a><a href="https://crates.parity.io">Reference Docs</a></div><div><h5>Community</h5><a href="/en/users.html">User Showcase</a><a href="http://stackoverflow.com/questions/tagged/substrate" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://riot.im/app/#/room/!HzySYSaIhtyWrwiwEV:matrix.org">Riot Chat</a><a href="https://twitter.com/ParityTech" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="https://www.parity.io/blog/">Blog</a><a href="https://github.com/substrate-developer-hub/substrate-developer-hub.github.io">GitHub</a><a class="github-button" href="https://github.com/substrate-developer-hub/substrate-developer-hub.github.io" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2019 Parity Technologies</section></footer></div></body></html>